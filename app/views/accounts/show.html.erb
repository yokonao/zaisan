<div class="max-w-4xl mx-auto space-y-8">
  <!-- Account Header -->
  <div class="bg-white rounded-2xl shadow-xl p-8">
    <div class="flex justify-between items-start mb-6">
      <div>
        <h1 class="text-3xl font-bold text-gray-800 mb-2">
          <%= @account.name || "名称未設定" %>
        </h1>
        <span class="inline-block px-4 py-2 text-sm font-medium rounded-full
          <%= case @account.account_type
              when 'mufg' then 'bg-red-100 text-red-700'
              when 'rakuten_sec' then 'bg-purple-100 text-purple-700'
              when 'daiwa_sec' then 'bg-blue-100 text-blue-700'
              else 'bg-gray-100 text-gray-700'
              end %>">
          <%= {'mufg' => '三菱UFJ銀行', 'rakuten_sec' => '楽天証券', 'daiwa_sec' => '大和証券', 'other' => 'その他'}[@account.account_type] %>
        </span>
      </div>
      
      <div class="flex space-x-2">
        <%= link_to "編集", edit_account_path(@account), class: "bg-gray-200 hover:bg-gray-300 text-gray-700 py-2 px-4 rounded-lg transition" %>
        <%= button_to "削除", @account, method: :delete, data: { confirm: "本当に削除しますか？" }, class: "bg-red-500 hover:bg-red-600 text-white py-2 px-4 rounded-lg transition cursor-pointer" %>
      </div>
    </div>
    
    <% if @account.description.present? %>
      <p class="text-gray-600 mb-6"><%= @account.description %></p>
    <% end %>
    
    <div class="bg-gradient-to-r from-indigo-500 to-purple-600 rounded-xl p-6 text-white">
      <p class="text-lg mb-2">現在の残高</p>
      <p class="text-4xl font-bold">¥<%= number_with_delimiter(@account.latest_amount) %></p>
      <% if @account.latest_snapshot %>
        <p class="text-indigo-100 mt-2">
          最終更新: <%= @account.latest_snapshot.recorded_at.strftime("%Y/%m/%d %H:%M") %>
        </p>
      <% end %>
    </div>
    
    <div class="mt-6">
      <%= link_to "残高を記録", new_account_account_snapshot_path(@account), class: "bg-gradient-to-r from-green-600 to-emerald-600 text-white py-3 px-6 rounded-lg font-medium hover:from-green-700 hover:to-emerald-700 transition transform hover:scale-105 inline-block" %>
    </div>
  </div>

  <!-- Snapshots History -->
  <div class="bg-white rounded-2xl shadow-xl p-8">
    <h2 class="text-2xl font-bold text-gray-800 mb-6">残高履歴</h2>
    
    <% if @snapshots.any? %>
      <div class="overflow-x-auto">
        <table class="w-full">
          <thead>
            <tr class="border-b border-gray-200">
              <th class="text-left py-3 px-4 font-medium text-gray-700">記録日時</th>
              <th class="text-right py-3 px-4 font-medium text-gray-700">残高</th>
              <th class="text-right py-3 px-4 font-medium text-gray-700">前回比</th>
              <th class="text-center py-3 px-4 font-medium text-gray-700">操作</th>
            </tr>
          </thead>
          <tbody>
            <% previous_amount = nil %>
            <% @snapshots.each_with_index do |snapshot, index| %>
              <% 
                next_snapshot = @snapshots[index + 1]
                difference = next_snapshot ? snapshot.amount - next_snapshot.amount : 0
              %>
              <tr class="border-b border-gray-100 hover:bg-gray-50">
                <td class="py-3 px-4">
                  <%= snapshot.recorded_at.strftime("%Y/%m/%d %H:%M") %>
                </td>
                <td class="text-right py-3 px-4 font-medium">
                  ¥<%= number_with_delimiter(snapshot.amount) %>
                </td>
                <td class="text-right py-3 px-4">
                  <% if next_snapshot %>
                    <span class="<%= difference >= 0 ? 'text-green-600' : 'text-red-600' %>">
                      <%= difference >= 0 ? '+' : '' %>¥<%= number_with_delimiter(difference) %>
                    </span>
                  <% else %>
                    <span class="text-gray-400">-</span>
                  <% end %>
                </td>
                <td class="text-center py-3 px-4">
                  <%= button_to "削除", account_account_snapshot_path(@account, snapshot), method: :delete, data: { confirm: "削除しますか？" }, class: "text-red-500 hover:text-red-700 text-sm cursor-pointer" %>
                </td>
              </tr>
            <% end %>
          </tbody>
        </table>
      </div>
    <% else %>
      <div class="text-center py-12">
        <svg class="w-16 h-16 text-gray-300 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
        </svg>
        <p class="text-gray-500">まだ記録がありません</p>
        <%= link_to "最初の記録を追加", new_account_account_snapshot_path(@account), class: "mt-4 inline-block text-indigo-600 hover:text-indigo-700 font-medium" %>
      </div>
    <% end %>
  </div>
</div>